{
  "export_metadata": {
    "timestamp": "2025-08-16T17:55:14.695406",
    "database_host": "localhost",
    "database_name": "test_data",
    "total_queries_executed": 4,
    "successful_queries": 4,
    "execution_order": [
      "favorite_products",
      "favorite_categories",
      "customer_product_patterns",
      "product_associations"
    ],
    "script_version": "2.0_flexible_db",
    "description": "Flexible business analytics queries with database storage",
    "analytics_run_id": 6
  },
  "configuration": {
    "display_limit": 5,
    "sample_data_limit": 3,
    "export_filename_template": "custom_analytics_results_{timestamp}.json",
    "timestamp_format": "%Y%m%d_%H%M%S"
  },
  "performance_summary": {
    "total_execution_time_ms": 47947.19,
    "total_rows_queried": 21677263,
    "average_response_time_ms": 11986.7975,
    "success_rate_percent": 100.0
  },
  "query_results": {
    "favorite_products": {
      "query_info": {
        "name": "favorite_products",
        "description": "Most popular products by total quantity sold from completed/shipped orders",
        "dataset_reference": "dataset 10",
        "sql": "SELECT p.product_id, p.product_name, p.brand, c.category_name, \n               SUM(oi.quantity) as total_quantity_sold,\n               COUNT(DISTINCT oi.order_id) as number_of_orders,\n               SUM(oi.total_price) as total_revenue\n        FROM Products p\n        JOIN Categories c ON p.category_id = c.category_id\n        JOIN Order_Items oi ON p.product_id = oi.product_id\n        JOIN Orders o ON oi.order_id = o.order_id\n        WHERE o.status IN ('completed', 'shipped') -- Nur abgeschlossene/versendete Bestellungen\n        GROUP BY p.product_id, p.product_name, p.brand, c.category_name\n        ORDER BY total_quantity_sold DESC;",
        "affected_tables": [
          "CATEGORIES",
          "ORDERS",
          "ORDER_ITEMS",
          "PRODUCTS"
        ],
        "execution_timestamp": "2025-08-16T17:54:21.544316",
        "execution_order": 1
      },
      "performance_metrics": {
        "response_time_ms": 2870.83,
        "response_time_seconds": 2.8708,
        "rows_returned": 1102137,
        "columns_returned": 7
      },
      "data_structure": {
        "column_names": [
          "product_id",
          "product_name",
          "brand",
          "category_name",
          "total_quantity_sold",
          "number_of_orders",
          "total_revenue"
        ],
        "sample_data": [
          [
            37939,
            "Four Authority",
            "Generic",
            "Effort Begin",
            35,
            10,
            10459.31
          ],
          [
            11692,
            "Second Institution",
            "Lenovo",
            "About Cover",
            35,
            11,
            9332.99
          ],
          [
            69849,
            "Since Happy",
            "Samsung",
            "Question Care",
            34,
            10,
            8144.91
          ]
        ],
        "data_types": [
          "int",
          "str",
          "str",
          "str",
          "int",
          "int",
          "Decimal"
        ]
      },
      "results_summary": {
        "has_data": true,
        "first_row": [
          37939,
          "Four Authority",
          "Generic",
          "Effort Begin",
          35,
          10,
          10459.31
        ],
        "total_data_points": 7714959
      }
    },
    "favorite_categories": {
      "query_info": {
        "name": "favorite_categories",
        "description": "Most popular product categories by total quantity sold",
        "dataset_reference": "dataset 8",
        "sql": "SELECT\n            c.category_id,\n            c.category_name,\n            c.description,\n            SUM(oi.quantity) as total_quantity_sold,\n            COUNT(DISTINCT oi.order_id) as number_of_orders,\n            COUNT(DISTINCT p.product_id) as number_of_products,\n            SUM(oi.total_price) as total_revenue,\n            ROUND(AVG(oi.unit_price), 2) as avg_unit_price\n        FROM Categories c\n        JOIN Products p ON c.category_id = p.category_id\n        JOIN Order_Items oi ON p.product_id = oi.product_id\n        JOIN Orders o ON oi.order_id = o.order_id\n        WHERE o.status IN ('completed', 'shipped')\n        GROUP BY c.category_id, c.category_name, c.description\n        ORDER BY total_quantity_sold DESC;",
        "affected_tables": [
          "CATEGORIES",
          "ORDERS",
          "ORDER_ITEMS",
          "PRODUCTS"
        ],
        "execution_timestamp": "2025-08-16T17:54:23.701655",
        "execution_order": 2
      },
      "performance_metrics": {
        "response_time_ms": 2109.21,
        "response_time_seconds": 2.1092,
        "rows_returned": 4000,
        "columns_returned": 8
      },
      "data_structure": {
        "column_names": [
          "category_id",
          "category_name",
          "description",
          "total_quantity_sold",
          "number_of_orders",
          "number_of_products",
          "total_revenue",
          "avg_unit_price"
        ],
        "sample_data": [
          [
            1324,
            "Throw Large",
            "Much money health certain bit white tell. Account long with.\nThis visit learn these. Evening instead plan tax main.",
            2365,
            785,
            421,
            593505.97,
            250.97
          ],
          [
            1760,
            "Because Reflect",
            "Machine beautiful ahead agreement. Life medical particular close let fund.\nWithout service magazine. Reduce develop church.\nSort last finish happen.",
            2282,
            742,
            411,
            591807.37,
            261.28
          ],
          [
            1161,
            "New Outside",
            "Responsibility notice choice treat sign. Perhaps blood color myself.\nTogether car next cover year wind pressure rather.",
            2277,
            739,
            409,
            583934.33,
            255.18
          ]
        ],
        "data_types": [
          "int",
          "str",
          "str",
          "int",
          "int",
          "int",
          "Decimal",
          "Decimal"
        ]
      },
      "results_summary": {
        "has_data": true,
        "first_row": [
          1324,
          "Throw Large",
          "Much money health certain bit white tell. Account long with.\nThis visit learn these. Evening instead plan tax main.",
          2365,
          785,
          421,
          593505.97,
          250.97
        ],
        "total_data_points": 32000
      }
    },
    "customer_product_patterns": {
      "query_info": {
        "name": "customer_product_patterns",
        "description": "Customer purchasing patterns - how often each customer buys each product",
        "dataset_reference": "dataset 10",
        "sql": "SELECT\n            c.customer_id,\n            CONCAT(c.first_name, ' ', c.last_name) as customer_name,\n            c.email,\n            p.product_id,\n            p.product_name,\n            p.brand,\n            cat.category_name,\n            SUM(oi.quantity) as total_quantity_purchased,\n            COUNT(DISTINCT o.order_id) as number_of_orders,\n            SUM(oi.total_price) as total_spent_on_product,\n            ROUND(AVG(oi.unit_price), 2) as avg_unit_price,\n            MIN(o.order_date) as first_purchase_date,\n            MAX(o.order_date) as last_purchase_date\n        FROM Customers c\n        JOIN Orders o ON c.customer_id = o.customer_id\n        JOIN Order_Items oi ON o.order_id = oi.order_id\n        JOIN Products p ON oi.product_id = p.product_id\n        JOIN Categories cat ON p.category_id = cat.category_id\n        WHERE o.status IN ('completed', 'shipped')\n        GROUP BY\n            c.customer_id, c.first_name, c.last_name, c.email,\n            p.product_id, p.product_name, p.brand, cat.category_name\n        ORDER BY total_quantity_purchased DESC, customer_name ASC, p.product_name ASC;",
        "affected_tables": [
          "CATEGORIES",
          "CUSTOMERS",
          "ORDERS",
          "ORDER_ITEMS",
          "PRODUCTS"
        ],
        "execution_timestamp": "2025-08-16T17:54:33.952502",
        "execution_order": 3
      },
      "performance_metrics": {
        "response_time_ms": 10097.64,
        "response_time_seconds": 10.0976,
        "rows_returned": 1801136,
        "columns_returned": 13
      },
      "data_structure": {
        "column_names": [
          "customer_id",
          "customer_name",
          "email",
          "product_id",
          "product_name",
          "brand",
          "category_name",
          "total_quantity_purchased",
          "number_of_orders",
          "total_spent_on_product",
          "avg_unit_price",
          "first_purchase_date",
          "last_purchase_date"
        ],
        "sample_data": [
          [
            340084,
            "Alexis Dyer",
            "user_139444_854313@testdata.com",
            439187,
            "This Surface",
            "Generic",
            "Can Much",
            9,
            1,
            1326.59,
            137.05,
            "2024-12-13T15:07:49.496459",
            "2024-12-13T15:07:49.496459"
          ],
          [
            25562,
            "Jaime Gross",
            "user_25561_272387@testdata.com",
            74956,
            "Author Bar",
            "Google",
            "Someone Another",
            8,
            1,
            1073.04,
            134.13,
            "2024-08-19T02:35:28.567182",
            "2024-08-19T02:35:28.567182"
          ],
          [
            42491,
            "Aaron Acosta",
            "user_42490_462364@testdata.com",
            240056,
            "Term For",
            "Samsung",
            "Action Cut",
            5,
            1,
            2320.2,
            464.04,
            "2025-04-30T03:28:08.589374",
            "2025-04-30T03:28:08.589374"
          ]
        ],
        "data_types": [
          "int",
          "str",
          "str",
          "int",
          "str",
          "str",
          "str",
          "int",
          "int",
          "Decimal",
          "Decimal",
          "datetime",
          "datetime"
        ]
      },
      "results_summary": {
        "has_data": true,
        "first_row": [
          340084,
          "Alexis Dyer",
          "user_139444_854313@testdata.com",
          439187,
          "This Surface",
          "Generic",
          "Can Much",
          9,
          1,
          1326.59,
          137.05,
          "2024-12-13T15:07:49.496459",
          "2024-12-13T15:07:49.496459"
        ],
        "total_data_points": 23414768
      }
    },
    "product_associations": {
      "query_info": {
        "name": "product_associations",
        "description": "Products that are frequently bought together - market basket analysis",
        "dataset_reference": "dataset 13",
        "sql": "SELECT\n            pa1.product_name as product_a,\n            pa1.brand as brand_a,\n            cat1.category_name as category_a,\n            pa2.product_name as product_b,\n            pa2.brand as brand_b,\n            cat2.category_name as category_b,\n            pa.frequency_count,\n            pa.last_calculated\n        FROM Product_Associations pa\n        JOIN Products pa1 ON pa.product_a_id = pa1.product_id\n        JOIN Products pa2 ON pa.product_b_id = pa2.product_id\n        JOIN Categories cat1 ON pa1.category_id = cat1.category_id\n        JOIN Categories cat2 ON pa2.category_id = cat2.category_id\n        ORDER BY pa.frequency_count DESC;",
        "affected_tables": [
          "CATEGORIES",
          "PRODUCTS",
          "PRODUCT_ASSOCIATIONS"
        ],
        "execution_timestamp": "2025-08-16T17:55:07.471241",
        "execution_order": 4
      },
      "performance_metrics": {
        "response_time_ms": 32869.51,
        "response_time_seconds": 32.8695,
        "rows_returned": 18769990,
        "columns_returned": 8
      },
      "data_structure": {
        "column_names": [
          "product_a",
          "brand_a",
          "category_a",
          "product_b",
          "brand_b",
          "category_b",
          "frequency_count",
          "last_calculated"
        ],
        "sample_data": [
          [
            "Person Page",
            "Apple",
            "Letter Economy",
            "Citizen Address",
            "Dell",
            "We Similar",
            4,
            "2025-08-16T15:30:55.452345"
          ],
          [
            "Up Commercial",
            "Sony",
            "Account Me",
            "Seem Manager",
            "Sony",
            "Board Ask",
            4,
            "2025-08-16T15:30:55.452345"
          ],
          [
            "Media Lay",
            "Asus",
            "Southern Positive",
            "Available Response",
            "Generic",
            "Billion Imagine",
            4,
            "2025-08-16T15:30:55.452345"
          ]
        ],
        "data_types": [
          "str",
          "str",
          "str",
          "str",
          "str",
          "str",
          "int",
          "datetime"
        ]
      },
      "results_summary": {
        "has_data": true,
        "first_row": [
          "Person Page",
          "Apple",
          "Letter Economy",
          "Citizen Address",
          "Dell",
          "We Similar",
          4,
          "2025-08-16T15:30:55.452345"
        ],
        "total_data_points": 150159920
      }
    }
  }
}