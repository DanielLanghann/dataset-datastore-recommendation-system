{
  "export_metadata": {
    "timestamp": "2025-08-16T15:50:40.239248",
    "database_host": "localhost",
    "database_name": "test_data",
    "total_queries_executed": 4,
    "successful_queries": 4,
    "execution_order": [
      "favorite_products",
      "favorite_categories",
      "customer_product_patterns",
      "product_associations"
    ],
    "script_version": "2.0_flexible",
    "description": "Flexible business analytics queries with loop-based execution"
  },
  "configuration": {
    "display_limit": 5,
    "sample_data_limit": 3,
    "export_filename_template": "custom_analytics_results_{timestamp}.json",
    "timestamp_format": "%Y%m%d_%H%M%S"
  },
  "performance_summary": {
    "total_execution_time_ms": 617.77,
    "total_rows_queried": 263469,
    "average_response_time_ms": 154.4425,
    "success_rate_percent": 100.0
  },
  "query_results": {
    "favorite_products": {
      "query_info": {
        "name": "favorite_products",
        "description": "Most popular products by total quantity sold from completed/shipped orders",
        "dataset_reference": "dataset 10",
        "sql": "SELECT p.product_id, p.product_name, p.brand, c.category_name, \n               SUM(oi.quantity) as total_quantity_sold,\n               COUNT(DISTINCT oi.order_id) as number_of_orders,\n               SUM(oi.total_price) as total_revenue\n        FROM Products p\n        JOIN Categories c ON p.category_id = c.category_id\n        JOIN Order_Items oi ON p.product_id = oi.product_id\n        JOIN Orders o ON oi.order_id = o.order_id\n        WHERE o.status IN ('completed', 'shipped') -- Nur abgeschlossene/versendete Bestellungen\n        GROUP BY p.product_id, p.product_name, p.brand, c.category_name\n        ORDER BY total_quantity_sold DESC;",
        "affected_tables": [
          "CATEGORIES",
          "ORDERS",
          "ORDER_ITEMS",
          "PRODUCTS"
        ],
        "execution_timestamp": "2025-08-16T15:50:39.698062",
        "execution_order": 1
      },
      "performance_metrics": {
        "response_time_ms": 93.26,
        "response_time_seconds": 0.0933,
        "rows_returned": 28569,
        "columns_returned": 7
      },
      "data_structure": {
        "column_names": [
          "product_id",
          "product_name",
          "brand",
          "category_name",
          "total_quantity_sold",
          "number_of_orders",
          "total_revenue"
        ],
        "sample_data": [
          [
            27815,
            "Security Material",
            "H&M",
            "Business Big",
            19,
            5,
            "4193.31"
          ],
          [
            91274,
            "Front Rock",
            "Lenovo",
            "Structure Commercial",
            16,
            4,
            "3515.11"
          ],
          [
            32004,
            "Term Research",
            "H&M",
            "Court Can",
            16,
            4,
            "3456.05"
          ]
        ],
        "data_types": [
          "int",
          "str",
          "str",
          "str",
          "int",
          "int",
          "Decimal"
        ]
      },
      "results_summary": {
        "has_data": true,
        "first_row": [
          27815,
          "Security Material",
          "H&M",
          "Business Big",
          19,
          5,
          "4193.31"
        ],
        "total_data_points": 199983
      }
    },
    "favorite_categories": {
      "query_info": {
        "name": "favorite_categories",
        "description": "Most popular product categories by total quantity sold",
        "dataset_reference": "dataset 8",
        "sql": "SELECT\n            c.category_id,\n            c.category_name,\n            c.description,\n            SUM(oi.quantity) as total_quantity_sold,\n            COUNT(DISTINCT oi.order_id) as number_of_orders,\n            COUNT(DISTINCT p.product_id) as number_of_products,\n            SUM(oi.total_price) as total_revenue,\n            ROUND(AVG(oi.unit_price), 2) as avg_unit_price\n        FROM Categories c\n        JOIN Products p ON c.category_id = p.category_id\n        JOIN Order_Items oi ON p.product_id = oi.product_id\n        JOIN Orders o ON oi.order_id = o.order_id\n        WHERE o.status IN ('completed', 'shipped')\n        GROUP BY c.category_id, c.category_name, c.description\n        ORDER BY total_quantity_sold DESC;",
        "affected_tables": [
          "CATEGORIES",
          "ORDERS",
          "ORDER_ITEMS",
          "PRODUCTS"
        ],
        "execution_timestamp": "2025-08-16T15:50:39.734446",
        "execution_order": 2
      },
      "performance_metrics": {
        "response_time_ms": 35.27,
        "response_time_seconds": 0.0353,
        "rows_returned": 1000,
        "columns_returned": 8
      },
      "data_structure": {
        "column_names": [
          "category_id",
          "category_name",
          "description",
          "total_quantity_sold",
          "number_of_orders",
          "number_of_products",
          "total_revenue",
          "avg_unit_price"
        ],
        "sample_data": [
          [
            1531,
            "Second Ever",
            "Activity democratic case challenge design. A office international home. Age compare it prepare family seek.",
            167,
            48,
            35,
            "45022.60",
            "264.83"
          ],
          [
            1027,
            "Reality Behavior",
            "Shoulder art moment follow. Him visit real data stay cut dark. We think poor agent.\nPolicy fine store article father enjoy. Away trade relationship when magazine. Bad our color themselves.",
            167,
            51,
            43,
            "41118.51",
            "258.89"
          ],
          [
            1888,
            "Ever Her",
            "Note wish apply quite. Music politics change long effect pick.",
            166,
            55,
            41,
            "39881.19",
            "237.40"
          ]
        ],
        "data_types": [
          "int",
          "str",
          "str",
          "int",
          "int",
          "int",
          "Decimal",
          "Decimal"
        ]
      },
      "results_summary": {
        "has_data": true,
        "first_row": [
          1531,
          "Second Ever",
          "Activity democratic case challenge design. A office international home. Age compare it prepare family seek.",
          167,
          48,
          35,
          "45022.60",
          "264.83"
        ],
        "total_data_points": 8000
      }
    },
    "customer_product_patterns": {
      "query_info": {
        "name": "customer_product_patterns",
        "description": "Customer purchasing patterns - how often each customer buys each product",
        "dataset_reference": "dataset 10",
        "sql": "SELECT\n            c.customer_id,\n            CONCAT(c.first_name, ' ', c.last_name) as customer_name,\n            c.email,\n            p.product_id,\n            p.product_name,\n            p.brand,\n            cat.category_name,\n            SUM(oi.quantity) as total_quantity_purchased,\n            COUNT(DISTINCT o.order_id) as number_of_orders,\n            SUM(oi.total_price) as total_spent_on_product,\n            ROUND(AVG(oi.unit_price), 2) as avg_unit_price,\n            MIN(o.order_date) as first_purchase_date,\n            MAX(o.order_date) as last_purchase_date\n        FROM Customers c\n        JOIN Orders o ON c.customer_id = o.customer_id\n        JOIN Order_Items oi ON o.order_id = oi.order_id\n        JOIN Products p ON oi.product_id = p.product_id\n        JOIN Categories cat ON p.category_id = cat.category_id\n        WHERE o.status IN ('completed', 'shipped')\n        GROUP BY\n            c.customer_id, c.first_name, c.last_name, c.email,\n            p.product_id, p.product_name, p.brand, cat.category_name\n        ORDER BY total_quantity_purchased DESC, customer_name ASC, p.product_name ASC;",
        "affected_tables": [
          "CATEGORIES",
          "CUSTOMERS",
          "ORDERS",
          "ORDER_ITEMS",
          "PRODUCTS"
        ],
        "execution_timestamp": "2025-08-16T15:50:39.898046",
        "execution_order": 3
      },
      "performance_metrics": {
        "response_time_ms": 162.71,
        "response_time_seconds": 0.1627,
        "rows_returned": 33577,
        "columns_returned": 13
      },
      "data_structure": {
        "column_names": [
          "customer_id",
          "customer_name",
          "email",
          "product_id",
          "product_name",
          "brand",
          "category_name",
          "total_quantity_purchased",
          "number_of_orders",
          "total_spent_on_product",
          "avg_unit_price",
          "first_purchase_date",
          "last_purchase_date"
        ],
        "sample_data": [
          [
            51564,
            "Aaron Brown",
            "user_51563_858115@testdata.com",
            40461,
            "System They",
            "Google",
            "Eat All",
            5,
            1,
            "1186.10",
            "237.22",
            "2024-10-24 11:25:33.516371",
            "2024-10-24 11:25:33.516371"
          ],
          [
            87122,
            "Aaron Hill",
            "user_87121_557499@testdata.com",
            4197,
            "Bed Natural",
            "Dell",
            "Apply Write",
            5,
            1,
            "2013.55",
            "402.71",
            "2025-08-01 13:14:34.134264",
            "2025-08-01 13:14:34.134264"
          ],
          [
            70514,
            "Aaron Hodges",
            "user_70513_903435@testdata.com",
            92606,
            "General Assume",
            "Microsoft",
            "Few Theory",
            5,
            1,
            "818.15",
            "163.63",
            "2025-07-07 08:27:16.518323",
            "2025-07-07 08:27:16.518323"
          ]
        ],
        "data_types": [
          "int",
          "str",
          "str",
          "int",
          "str",
          "str",
          "str",
          "int",
          "int",
          "Decimal",
          "Decimal",
          "datetime",
          "datetime"
        ]
      },
      "results_summary": {
        "has_data": true,
        "first_row": [
          51564,
          "Aaron Brown",
          "user_51563_858115@testdata.com",
          40461,
          "System They",
          "Google",
          "Eat All",
          5,
          1,
          "1186.10",
          "237.22",
          "2024-10-24 11:25:33.516371",
          "2024-10-24 11:25:33.516371"
        ],
        "total_data_points": 436501
      }
    },
    "product_associations": {
      "query_info": {
        "name": "product_associations",
        "description": "Products that are frequently bought together - market basket analysis",
        "dataset_reference": "dataset 13",
        "sql": "SELECT\n            pa1.product_name as product_a,\n            pa1.brand as brand_a,\n            cat1.category_name as category_a,\n            pa2.product_name as product_b,\n            pa2.brand as brand_b,\n            cat2.category_name as category_b,\n            pa.frequency_count,\n            pa.last_calculated\n        FROM Product_Associations pa\n        JOIN Products pa1 ON pa.product_a_id = pa1.product_id\n        JOIN Products pa2 ON pa.product_b_id = pa2.product_id\n        JOIN Categories cat1 ON pa1.category_id = cat1.category_id\n        JOIN Categories cat2 ON pa2.category_id = cat2.category_id\n        ORDER BY pa.frequency_count DESC;",
        "affected_tables": [
          "CATEGORIES",
          "PRODUCTS",
          "PRODUCT_ASSOCIATIONS"
        ],
        "execution_timestamp": "2025-08-16T15:50:40.229724",
        "execution_order": 4
      },
      "performance_metrics": {
        "response_time_ms": 326.53,
        "response_time_seconds": 0.3265,
        "rows_returned": 200323,
        "columns_returned": 8
      },
      "data_structure": {
        "column_names": [
          "product_a",
          "brand_a",
          "category_a",
          "product_b",
          "brand_b",
          "category_b",
          "frequency_count",
          "last_calculated"
        ],
        "sample_data": [
          [
            "Skin Continue",
            "HP",
            "Home & Garden",
            "Choice How",
            "HP",
            "Mention How",
            4,
            "2025-08-16 13:40:10.172401"
          ],
          [
            "Skin Continue",
            "HP",
            "Home & Garden",
            "Admit Talk",
            "Lenovo",
            "Mr Deal",
            4,
            "2025-08-16 13:40:10.172401"
          ],
          [
            "Score Career",
            "Asus",
            "Ahead Before",
            "Take Figure",
            "Adidas",
            "Very Floor",
            4,
            "2025-08-16 13:40:10.172401"
          ]
        ],
        "data_types": [
          "str",
          "str",
          "str",
          "str",
          "str",
          "str",
          "int",
          "datetime"
        ]
      },
      "results_summary": {
        "has_data": true,
        "first_row": [
          "Skin Continue",
          "HP",
          "Home & Garden",
          "Choice How",
          "HP",
          "Mention How",
          4,
          "2025-08-16 13:40:10.172401"
        ],
        "total_data_points": 1602584
      }
    }
  }
}